<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Площадка</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        html, body { width: 100%; height: 100%; margin: 0; overflow: hidden; }
        canvas { width: 100%; height: 100%; display: block; }
    </style>
</head>
<body>
    <!-- Кнопка запуска приложения -->
    <div id="launchContainer">
        <button id="launchApp">Запустить приложение</button>
    </div>
    
    <!-- Модальное окно -->
    <div id="appModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <button id="closeAppButton">Закрыть приложение</button>
            
            <div id="sidebar">
                <h3>Выберите элемент</h3>
                <div class="item" draggable="true" data-model="0001.glb">
                    <img src="textures/MG0001 Качели-балансир двойной.png" alt="MG0001 Качели-балансир двойной">
                    <p>MG0001 Качели-балансир двойной</p>
                </div>
                <div class="item" draggable="true" data-model="242.glb">
                    <img src="textures/ЛГГ-24-2 Горка h=950 (HPL).png" alt="ЛГГ-24-2 Горка h=950 (HPL)">
                    <p>ЛГГ-24-2 Горка h=950 (HPL)</p>
                </div>
                <div class="item" draggable="true" data-model="0502.glb">
                    <img src="textures/MG0502 Качели одинарные.png" alt="MG0502 Качели одинарные">
                    <p>MG0502 Качели одинарные</p>
                </div>
                <div class="item" draggable="true" data-model="0519.glb">
                    <img src="textures/Качели 0519.png" alt="Качели 0519">
                    <p>Качели 0519</p>
                </div>
                <div class="item" draggable="true" data-model="3540.glb">
                    <img src="textures/MG3540 Спортивное оборудование Лазательный комплекс.png" alt="MG3540 Спортивное оборудование Лазательный комплекс">
                    <p>MG3540 Спортивное оборудование Лазательный комплекс</p>
                </div>
                <div class="item" draggable="true" data-model="4209.glb">
                    <img src="textures/MG4209 Спортивный комплекс.png" alt="MG4209 Спортивный комплекс">
                    <p>MG4209 Спортивный комплекс</p>
                </div>
                <div class="item" draggable="true" data-model="Taiga_v1.glb">
                    <img src="textures/Каркас качелей-балансира -Тайга-.png" alt="Каркас качелей-балансира -Тайга-">
                    <p>Каркас качелей-балансира Тайга</p>
                </div>
                <div class="item" draggable="true" data-model="lgd_3.glb">
                    <img src="textures/lgd_3.png" alt="Модель lgd_3">
                    <p>Модель lgd_3</p>
                </div>
                <div class="item" draggable="true" data-model="lgk_11.glb">
                    <img src="textures/lgk_11.png" alt="Модель lgk_11">
                    <p>Модель lgk_11</p>
                </div>
                <div class="item" draggable="true" data-model="миссури.glb">
                    <img src="textures/lgk_314.png" alt="Модель lgk_314">
                    <p>Модель lgk_314</p>
                </div>
                <div class="item" draggable="true" data-model="MG0001 2024-09 R2 Модель.glb">
                    <img src="textures/MG0001 Качели-балансир двойной.png" alt="MG0001 Качели-балансир двойной">
                    <p>MG0001 Качели-балансир двойной</p>
                </div>
                <div class="item" draggable="true" data-model="дуга.glb">
                    <img src="textures/msk_105.png" alt="Модель msk_105">
                    <p>Модель msk_105</p>
                </div>
                <div class="item" draggable="true" data-model="msk_201.glb">
                    <img src="textures/msk_201.png" alt="Модель msk_201">
                    <p>Модель msk_201</p>
                </div>
            </div>
            
            <canvas id="renderCanvas"></canvas>
            
            <div id="controlPanel">
                <div class="control-panel">
                    <h4>Настройки площадки</h4>
                    <div class="control-group">
                        <label for="playgroundType">Тип площадки:</label>
                        <select id="playgroundType">
                            <option value="playground.glb" selected>Стандартная</option>
                            <option value="projeto_piloto-puc_minas-rota_3.glb">PUC Minas Rota 3</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="playgroundWidth">Ширина (м):</label>
                        <input type="number" id="playgroundWidth" min="5" max="50" value="10" step="1">
                    </div>
                    <div class="control-group">
                        <label for="playgroundLength">Длина (м):</label>
                        <input type="number" id="playgroundLength" min="5" max="50" value="10" step="1">
                    </div>
        
                    <button id="applySettings">Применить</button>
                    <button id="changePlayground">Сменить площадку</button>
                    <button id="resetView" style="margin-top: 10px; background-color: #2196F3;">Сбросить вид</button>
                    <button id="topView" style="margin-top: 10px; background-color: #4CAF50;">Вид сверху</button>
                    <button id="saveScreenshot" style="margin-top: 10px; background-color: #673AB7;">Сделать скриншот</button>
                    <div id="playgroundStatus" style="margin-top: 10px; font-size: 12px; color: #666;">
                        Установите размеры площадки и нажмите "Применить"
                    </div>
                </div>
                <table id="elementsTable">
                    <thead>
                        <tr>
                            <th>Элемент</th>
                            <th>Размер</th>
                            <th>Действие</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div id="dimensionLabels">
                <div id="widthLabel" class="dimension-label">10м</div>
                <div id="lengthLabel" class="dimension-label">10м</div>
            </div>
        </div>
    </div>
    
    <!-- Уведомления -->
    <div id="notification" class="notification hidden">
        <div class="notification-content">
            <span class="notification-message">Объект не может быть размещен в этой позиции!</span>
            <span class="notification-close" onclick="document.getElementById('notification').classList.add('hidden')">&times;</span>
        </div>
    </div>
    
    <!-- Подключаем модули JavaScript -->
    <script type="module" src="js/app.js"></script>
    <script type="module" src="js/modal.js"></script>
    
    <!-- Временный отладочный код -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Отладка: DOMContentLoaded сработал');
            console.log('window.initApp существует:', typeof window.initApp === 'function');
            console.log('window.appInitialized:', window.appInitialized);
            
            // Код для отладки кнопки запуска
            const launchButton = document.getElementById('launchApp');
            if (launchButton) {
                console.log('Отладка: Кнопка запуска найдена');
                launchButton.addEventListener('click', () => {
                    console.log('Отладка: Дополнительный обработчик кнопки запуска сработал');
                    console.log('window.initApp существует после клика:', typeof window.initApp === 'function');
                    console.log('window.appInitialized после клика:', window.appInitialized);
                    
                    // Отображаем модальное окно напрямую
                    const modal = document.getElementById('appModal');
                    if (modal) {
                        console.log('Отображаем модальное окно напрямую из отладочного скрипта');
                        modal.style.display = 'block';
                        document.getElementById('launchContainer').style.display = 'none';
                        
                        // Запускаем инициализацию приложения, если функция существует
                        if (typeof window.initApp === 'function') {
                            console.log('Вызываем window.initApp() напрямую из отладочного скрипта');
                            window.initApp();
                        } else {
                            console.error('window.initApp не определена в момент клика!');
                        }
                    } else {
                        console.error('Модальное окно не найдено!');
                    }
                });
            } else {
                console.log('Отладка: Кнопка запуска НЕ найдена');
            }
        });
    </script>
</body>
</html>