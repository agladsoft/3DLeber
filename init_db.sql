-- Создание таблицы пользователей
CREATE TABLE IF NOT EXISTS projects (
    id SERIAL PRIMARY KEY,
    project_id VARCHAR(50) UNIQUE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Создание таблицы моделей
CREATE TABLE IF NOT EXISTS models (
    id SERIAL PRIMARY KEY,
    article VARCHAR(50) UNIQUE NOT NULL,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    category VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Создание таблицы сессий
CREATE TABLE IF NOT EXISTS sessions (
    project_id INTEGER REFERENCES projects(id) UNIQUE,
    session_data JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Добавляем комментарии
COMMENT ON TABLE sessions IS 'Таблица для хранения сессий пользователей';
COMMENT ON COLUMN sessions.session_data IS 'JSON данные сессии, включая размещенные модели и их координаты'; 

-- Создание индексов для оптимизации запросов
CREATE INDEX IF NOT EXISTS idx_models_name ON models(name);
CREATE INDEX IF NOT EXISTS idx_models_category ON models(category);

-- Добавление комментариев к таблицам
COMMENT ON TABLE projects IS 'Таблица проектов';
COMMENT ON TABLE models IS 'Таблица моделей игрового оборудования';
COMMENT ON TABLE sessions IS 'Таблица сессий, связывающая пользователей и модели';

-- Добавление комментариев к колонкам
COMMENT ON COLUMN projects.project_id IS 'Уникальный идентификатор проекта';
COMMENT ON COLUMN models.article IS 'Артикул модели';
COMMENT ON COLUMN models.name IS 'Название модели';
COMMENT ON COLUMN models.description IS 'Описание модели';
COMMENT ON COLUMN models.category IS 'Категория модели';

-- Вставка тестового проекта
INSERT INTO projects (project_id) 
VALUES ('id_12345678')
ON CONFLICT (project_id) DO NOTHING;

-- Вставка моделей
INSERT INTO models (article, name, description, category) VALUES
    ('ЛГД-19', 'ЛГД-19 Домик Белочка (TE319)', 'Детский игровой домик "Белочка"', 'Домики'),
    ('ЛГК-24.7', 'ЛГК-24.7 Качалка на пружине Рыбка', 'Качалка на пружине "Рыбка"', 'Качалки'),
    ('ЛГИК-7.26', 'ЛГИК-7.26 Игровой комплекс Весна-6 (TE706)', 'Игровой комплекс "Весна-6"', 'Комплексы'),
    ('ЛГИК-7.03', 'ЛГИК-7.03 Игровой комплекс Черепашка (TE703)', 'Игровой комплекс "Черепашка"', 'Комплексы'),
    ('ЛГИК-7.01', 'ЛГИК-7.01 Игровой комплекс Весна (TE701)', 'Игровой комплекс "Весна"', 'Комплексы'),
    ('ЛГД-29', 'ЛГД-29 Домик Спускаемый модуль (1384)', 'Детский игровой домик "Спускаемый модуль"', 'Домики'),
    ('ЛГД-25', 'ЛГД-25 Домик Вертолет (3701.2)', 'Детский игровой домик "Вертолет"', 'Домики'),
    ('ЛГД-23', 'ЛГД-23 Домик Деревня (TE323)', 'Детский игровой домик "Деревня"', 'Домики'),
    ('ЛГД-14', 'ЛГД-14 Беседка Хижина (1364)', 'Детская беседка "Хижина"', 'Беседки'),
    ('ЛГВО-421', 'ЛГВО-421 Спортивный комплекс ЛГВО-421 (Нержавеющая сталь) (2279.50)', 'Спортивный комплекс из нержавеющей стали', 'Спортивные комплексы')
ON CONFLICT (article) DO UPDATE 
SET name = EXCLUDED.name,
    description = EXCLUDED.description,
    category = EXCLUDED.category;

-- Вставка моделей из GLB файлов
INSERT INTO models (article, name, description, category) VALUES
    ('ЛГИК-02.01', 'ЛГИК-02.01 Игровой комплекс Рёло 02.01', 'Игровой комплекс Рёло 02.01', 'Комплексы'),
    ('ЛГИК-02.18', 'ЛГИК-02.18 Игровой комплекс Рёло 02.18', 'Игровой комплекс Рёло 02.18', 'Комплексы'),
    ('ЛГИК-02.17-1', 'ЛГИК-02.17-1 Игровой комплекс Рёло', 'Игровой комплекс Рёло', 'Комплексы'),
    ('ЛГИК-02.17', 'ЛГИК-02.17 Игровой комплекс Рёло 02.17', 'Игровой комплекс Рёло 02.17', 'Комплексы'),
    ('ЛГИК-02.16', 'ЛГИК-02.16 Игровой комплекс Рёло 02.16', 'Игровой комплекс Рёло 02.16', 'Комплексы'),
    ('ЛГИК-02.14', 'ЛГИК-02.14 Игровой комплекс Рёло 02.14', 'Игровой комплекс Рёло 02.14', 'Комплексы'),
    ('ЛГИК-02.13', 'ЛГИК-02.13 Игровой комплекс Рёло 02.13', 'Игровой комплекс Рёло 02.13', 'Комплексы'),
    ('ЛГИК-02.12', 'ЛГИК-02.12 Игровой комплекс Рёло 02.12', 'Игровой комплекс Рёло 02.12', 'Комплексы'),
    ('ЛГИК-02.11', 'ЛГИК-02.11 Игровой комплекс Рёло 02.11', 'Игровой комплекс Рёло 02.11', 'Комплексы'),
    ('ЛГИК-02.04', 'ЛГИК-02.04 Игровой комплекс Рёло 02.04', 'Игровой комплекс Рёло 02.04', 'Комплексы'),
    ('ЛГИК-02.03', 'ЛГИК-02.03 Игровой комплекс Рёло 02.03', 'Игровой комплекс Рёло 02.03', 'Комплексы'),
    ('ЛГИК-02.02', 'ЛГИК-02.02 Игровой комплекс Рёло 02.02', 'Игровой комплекс Рёло 02.02', 'Комплексы'),
    ('ЛГД-16.06', 'ЛГД-16.06 Домик Бриум 16.06', 'Домик Бриум 16.06', 'Домики'),
    ('ЛГИК-16.01', 'ЛГИК-16.01 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.02', 'ЛГИК-16.02 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.03', 'ЛГИК-16.03 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.04', 'ЛГИК-16.04 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.05', 'ЛГИК-16.05 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.10', 'ЛГИК-16.10 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.11', 'ЛГИК-16.11 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.12', 'ЛГИК-16.12 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.13', 'ЛГИК-16.13 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.14', 'ЛГИК-16.14 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы'),
    ('ЛГИК-16.15', 'ЛГИК-16.15 Игровой комплекс Бриум', 'Игровой комплекс Бриум', 'Комплексы')
ON CONFLICT (article) DO UPDATE 
SET name = EXCLUDED.name,
    description = EXCLUDED.description,
    category = EXCLUDED.category;

-- Добавление моделей деревьев, кустарников, пальм и людей
INSERT INTO models (article, name, description, category) VALUES
    -- Деревья
    ('TREE-001', 'tree_test', 'Тестовое дерево', 'Деревья'),
    ('TREE-002', 'tree_for_games', 'Дерево для игр', 'Деревья'),
    ('TREE-003', 'tree_elm', 'Вяз', 'Деревья'),
    ('TREE-004', 'tree_3d_model_linden_tree', '3D модель липы', 'Деревья'),
    ('TREE-005', 'realistic_tree', 'Реалистичное дерево', 'Деревья'),
    ('TREE-006', 'realistic_tree_2_free', 'Реалистичное дерево 2', 'Деревья'),
    ('TREE-007', 'realistic_high_poly_tree', 'Реалистичное высокополигональное дерево', 'Деревья'),
    ('TREE-008', 'maple_tree', 'Клён', 'Деревья'),
    ('TREE-009', 'pine_tree (2)', 'Сосна', 'Деревья'),
    ('TREE-010', 'realistic_hd_hong_kong_orchid_tree_1540', 'Гонконгское орхидейное дерево', 'Деревья'),
    -- Пальмы
    ('PALM-001', 'realistic_palm_tree_4_free', 'Реалистичная пальма 4', 'Пальмы'),
    ('PALM-002', 'realistic_hd_christmas_palm_935', 'Рождественская пальма', 'Пальмы'),
    ('PALM-003', 'realistic_hd_alexander_palm_2830', 'Пальма Александра', 'Пальмы'),
    ('PALM-004', 'realistic_hd_alexander_palm_2830 (1)', 'Пальма Александра (вариант 2)', 'Пальмы'),
    ('PALM-005', 'palm_tree_55k_triangles', 'Пальма (55k треугольников)', 'Пальмы'),
    ('PALM-006', 'palm_tree', 'Пальма', 'Пальмы'),
    ('PALM-007', 'free_game_ready_palm', 'Игровая пальма', 'Пальмы'),
    ('PALM-008', 'date_palm', 'Финиковая пальма', 'Пальмы'),
    ('PALM-009', 'coconut_tree_low_poly', 'Кокосовая пальма (низкополигональная)', 'Пальмы'),
    ('PALM-010', 'coconut_palm', 'Кокосовая пальма', 'Пальмы'),
    -- Кустарники и растения
    ('BUSH-001', 'bush', 'Кустарник базовый', 'Кустарники'),
    ('BUSH-002', 'realistic_bushtree_dwarf_umbrella', 'Карликовое зонтичное дерево-куст', 'Кустарники'),
    ('BUSH-003', 'photorealistic_bush', 'Фотореалистичный куст', 'Кустарники'),
    ('BUSH-004', 'low_poly_bush_buxus', 'Самшит (низкополигональный)', 'Кустарники'),
    ('BUSH-005', 'realistic_hd_yellow_bush_lupine_2425', 'Жёлтый куст люпина 2425', 'Кустарники'),
    ('BUSH-006', 'realistic_hd_yellow_bush_lupine_2425 (1)', 'Жёлтый куст люпина 2425 (вариант 2)', 'Кустарники'),
    ('BUSH-007', 'realistic_hd_yellow_bush_lupine_225', 'Жёлтый куст люпина 225', 'Кустарники'),
    ('BUSH-008', 'realistic_hd_yellow_bush_lupine_2225', 'Жёлтый куст люпина 2225', 'Кустарники'),
    ('BUSH-009', 'realistic_hd_yellow_bush_lupine_2025', 'Жёлтый куст люпина 2025', 'Кустарники'),
    ('BUSH-010', 'realistic_hd_yellow_bush_lupine_1625', 'Жёлтый куст люпина 1625', 'Кустарники'),
    ('BUSH-011', 'realistic_hd_yellow_bush_lupine_1525', 'Жёлтый куст люпина 1525', 'Кустарники'),
    ('BUSH-012', 'realistic_hd_yellow_bush_lupine_125', 'Жёлтый куст люпина 125', 'Кустарники'),
    ('BUSH-013', 'realistic_hd_yellow_bush_lupine_1125', 'Жёлтый куст люпина 1125', 'Кустарники'),
    -- Люди
    ('PEOPLE-001', 'teen_boy_running__rigged__free', 'Бегущий подросток (с риггингом)', 'Люди'),
    ('PEOPLE-002', 'nathan_animated_003_-_walking_3d_man', 'Натан - идущий человек (анимированный)', 'Люди')
ON CONFLICT (article) DO UPDATE 
SET name = EXCLUDED.name,
    description = EXCLUDED.description,
    category = EXCLUDED.category;